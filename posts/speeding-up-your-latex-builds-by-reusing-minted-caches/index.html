<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Speeding up your LaTeX builds by reusing minted caches | In Absentia</title>
  <meta name="description" content="by Igal Tabachnik">
  <meta name="keywords" content="programming, software, scala, haskell, functional programming">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Speeding up your LaTeX builds by reusing minted caches">
  <meta property="og:description" content="by Igal Tabachnik">
  <meta property="og:url" content="https:&#x2F;&#x2F;hmemcpy.com&#x2F;posts&#x2F;speeding-up-your-latex-builds-by-reusing-minted-caches&#x2F;">
  
    <meta property="og:site_name" content="In Absentia">
  
  

  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@hmemcpy">
  

  
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="https://hmemcpy.com/atom.xml">
  

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&family=Lora:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link rel="stylesheet" href="https://hmemcpy.com/linen.css?h=7516597de5795edf0603">
</head>

<body>
  <div class="headband"></div>

  <header class="site-header">
    <div class="header-inner">
      <a href="https:&#x2F;&#x2F;hmemcpy.com" class="site-brand">
        <span class="site-title">In Absentia</span>
      </a>

      <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
      </button>

      
        <nav class="site-nav">
          <ul class="nav-menu">
            
              <li class="nav-item">
                <a href="&#x2F;">Home</a>
              </li>
            
              <li class="nav-item">
                <a href="&#x2F;posts&#x2F;">Archives</a>
              </li>
            
              <li class="nav-item">
                <a href="&#x2F;talks-i-liked&#x2F;">Talks I liked</a>
              </li>
            
              <li class="nav-item">
                <a href="&#x2F;cv.pdf">CV</a>
              </li>
            
          </ul>
        </nav>
      

      <div class="header-search" id="header-search">
        <i class="fa-solid fa-magnifying-glass search-icon"></i>
        <input
          type="search"
          id="search-input"
          class="search-input"
          placeholder="Search…"
          autocomplete="off"
          aria-label="Search posts"
        >
        <ul class="search-results" id="search-results" hidden></ul>
      </div>
    </div>
  </header>

  <main class="main">
    <div class="main-inner">
      
<article class="post-block">
  <header class="post-header">
    <h1 class="post-title">Speeding up your LaTeX builds by reusing minted caches</h1>
    
    <div class="post-meta">
      <span class="post-meta-item">
        <span class="post-meta-item-icon"><i class="far fa-calendar"></i></span>
        <time datetime="2020-02-15T16:35:51Z">2020-02-15</time>
      </span>

      

      
        <span class="post-meta-item">
          <span class="post-meta-item-icon"><i class="far fa-clock"></i></span>
          2 min read
        </span>
      

      
        <a class="edit-link" href="https:&#x2F;&#x2F;github.com&#x2F;hmemcpy&#x2F;hmemcpy.com/edit/main/content/posts&#x2F;speeding-up-your-latex-builds-by-reusing-minted-caches.md" target="_blank" rel="noopener" title="Edit on GitHub">
          <i class="fa-solid fa-pencil"></i>
        </a>
      

      
    </div>
    
  </header>

  <div class="post-body">
    <p>Over the past two years, the PDF version of Bartosz Milewski's <a rel="external" href="https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/"><em>Category Theory for Programmers</em></a> became a highly-successful <a rel="external" href="https://github.com/hmemcpy/milewski-ctfp-pdf">open-source book</a>, which was adapted to other programming languages, such as Scala and OCaml. Unfortunately, building this 400+ page PDF from LaTeX sources in multiple editions took a significant amount of time, sometimes upwards of 15 minutes. One of the reasons was, all the code snippets are loaded from external code files (so that they can be easily adapted to other programming languages), and they have to be compiled each time in a format LaTeX understands.</p>
<p>I recently explored some possibilities to reduce the time it takes for the snippets to build, and I'm happy to report the results: a <strong>60% improvement</strong> overall! Big thanks to <em>muzimuzhi</em> from the <a rel="external" href="https://github.com/gpoore/minted/issues/252">minted github</a>, who generously helped me to arrive at the solution below.</p>
<p>Here's a quick summary of my changes, that resulted in reducing my <a rel="external" href="https://travis-ci.org/hmemcpy/milewski-ctfp-pdf/builds">Travis CI builds</a> from 14-16 minutes to mere 6!</p>
<span id="continue-reading"></span><h4 id="changes-to-minted">Changes to minted</h4>
<ol>
<li>Configure minted cache parameter <code>cachedir</code> to output to a single directory (e.g. <code>_minted-caches</code>) in all your <code>.tex</code> files (or in a common preamble)</li>
<li>Pass the <code>-jobname</code> argument to <code>latexmk</code> with the <em>same name</em> for all builds (e.g. <code>-jobname=ctfp</code>)
<ul>
<li>Note: this causes the output PDF filename to be <code>{jobname}.pdf</code>, you will have to tweak your Makefile/build script to rename/copy this filename to the right location with a new name.</li>
</ul>
</li>
<li>Override the <code>\minted@cleancache</code> command to do <em>nothing</em>, to prevent it from cleaning out the unused cache files:</li>
</ol>
<pre class="giallo" style="color: #D8DEE9; background-color: #2E3440;"><code data-lang="tex"><span class="giallo-l"><span style="color: #616E88;">% prevents cleaning up the cache at the end of the run (needed to keep the unused caches, generated by other editions)</span></span>
<span class="giallo-l"><span style="color: #ECEFF4;">\</span><span style="color: #88C0D0;">makeatletter</span></span>
<span class="giallo-l"><span style="color: #ECEFF4;">\</span><span style="color: #88C0D0;">renewcommand</span><span>*{</span><span style="color: #ECEFF4;">\</span><span style="color: #88C0D0;">minted@cleancache</span><span>}{}</span></span>
<span class="giallo-l"><span style="color: #ECEFF4;">\</span><span style="color: #88C0D0;">makeatother</span></span></code></pre>
<ol start="4">
<li>(optional) If you're using a <code>-pdf</code> flag in your <code>latexmk</code> command, consider using <code>-pdfxe</code> instead - it will cause latexmk to generate the pdf file for the last run only, generating intermediate xdv files (hence saving the time of xdv-to-pdf conversion) for other runs.</li>
</ol>
<h4 id="changes-to-travis-ci">Changes to Travis CI</h4>
<p>If you're building the PDF on a CI server, such as Travis CI, configure caching for the minted caches, to enable retrieving them between builds. Read the <a rel="external" href="https://docs.travis-ci.com/user/caching/">caching documentation</a> for Travis CI for details.</p>

  </div>

  
  <footer class="post-footer">
    

    
<div class="post-nav">
  
    <div class="post-nav-item post-nav-next">
      <a href="https:&#x2F;&#x2F;hmemcpy.com&#x2F;posts&#x2F;setting-up-a-haskell-development-environment-in-minutes-in-vscode&#x2F;" rel="next" title="Setting up a Haskell development environment in minutes in Visual Studio Code">
        <i class="fa fa-angle-left"></i> <span class="nav-title">Setting up a Haskell development environment in minutes in Visual Studio Code</span>
      </a>
    </div>
  
  
    <div class="post-nav-item post-nav-prev">
      <a href="https:&#x2F;&#x2F;hmemcpy.com&#x2F;posts&#x2F;everything-i-learned-about-self-publishing-an-open-source-book&#x2F;" rel="prev" title="Everything I learned about self-publishing an open-source book">
        <span class="nav-title">Everything I learned about self-publishing an open-source book</span> <i class="fa fa-angle-right"></i>
      </a>
    </div>
  
</div>

  </footer>
  
</article>

    </div>
  </main>

  <footer class="site-footer">
    <div class="footer-inner">
      
        <div class="footer-social">
          
            <a href="https:&#x2F;&#x2F;github.com&#x2F;hmemcpy" title="GitHub" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          
            <a href="https:&#x2F;&#x2F;x.com&#x2F;hmemcpy" title="X" target="_blank" rel="noopener">
              <i class="fab fa-x-twitter"></i>
            </a>
          
            <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;8205&#x2F;igal-tabachnik" title="Stack Overflow" target="_blank" rel="noopener">
              <i class="fab fa-stack-overflow"></i>
            </a>
          
            <a href="https:&#x2F;&#x2F;il.linkedin.com&#x2F;in&#x2F;igaltabachnik" title="LinkedIn" target="_blank" rel="noopener">
              <i class="fab fa-linkedin"></i>
            </a>
          
        </div>
      
      <div class="footer-copyright">
        &copy;
        2009 &ndash; 
        2026
        <span class="author">Igal Tabachnik</span>
      </div>
    </div>
  </footer>

  <script>
    // Nav hamburger
    var navToggle = document.querySelector('.nav-toggle');
    if (navToggle) {
      navToggle.addEventListener('click', function() {
        var nav = document.querySelector('.site-nav');
        var open = nav.classList.toggle('open');
        this.setAttribute('aria-expanded', open);
      });
    }

    // Search — uses Pagefind JS API directly
    (async function() {
      var input   = document.getElementById('search-input');
      var results = document.getElementById('search-results');
      var pagefind;

      try {
        pagefind = await import('/pagefind/pagefind.js');
        await pagefind.options({ excerptLength: 12 });
      } catch(e) {
        return; // Pagefind not built yet (local dev) — fail silently
      }

      async function runSearch(query) {
        if (!query) { results.hidden = true; return; }
        var res = await pagefind.search(query);
        var hits = await Promise.all(res.results.slice(0, 8).map(function(r) { return r.data(); }));
        if (!hits.length) { results.hidden = true; return; }
        results.innerHTML = hits.map(function(hit) {
          return '<li class="search-result"><a href="' + hit.url + '">'
            + '<span class="result-title">' + (hit.meta && hit.meta.title ? hit.meta.title : hit.url) + '</span>'
            + '<span class="result-excerpt">' + hit.excerpt + '</span>'
            + '</a></li>';
        }).join('');
        results.hidden = false;
      }

      input.addEventListener('input', function() { runSearch(this.value.trim()); });

      document.addEventListener('click', function(e) {
        if (!document.getElementById('header-search').contains(e.target)) {
          results.hidden = true;
        }
      });

      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') { results.hidden = true; input.blur(); }
        if (e.key === '/' && document.activeElement !== input
            && document.activeElement.tagName !== 'INPUT'
            && document.activeElement.tagName !== 'TEXTAREA') {
          e.preventDefault();
          input.focus();
        }
      });
    })();
  </script>
</body>
</html>
